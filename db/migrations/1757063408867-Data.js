module.exports = class Data1757063408867 {
    name = 'Data1757063408867'

    async up(db) {
        await db.query(`CREATE TABLE "location" ("id" character varying NOT NULL, "name" text NOT NULL, "address" text, "latitude" text NOT NULL, "longitude" text NOT NULL, "place_id" text, "metadata_id" character varying, CONSTRAINT "PK_876d7bdba03c72251ec4c2dc827" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_2c7b2ffbd1f600a35f87317f7a" ON "location" ("metadata_id") `)
        await db.query(`CREATE TABLE "event_metadata" ("id" character varying NOT NULL, "reference_hash" text NOT NULL, "title" text NOT NULL, "description" text NOT NULL, "image" text, "virtual_link" text, "event_id" character varying, "location_id" character varying, CONSTRAINT "PK_f9e5249129bc322437853cf93fd" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_0817c16131339484069f1af3cb" ON "event_metadata" ("event_id") `)
        await db.query(`CREATE INDEX "IDX_e3d88724099f9665ad312a39f7" ON "event_metadata" ("location_id") `)
        await db.query(`CREATE TABLE "registration" ("id" character varying NOT NULL, "attendee" text NOT NULL, "status" character varying(8) NOT NULL, "approved" boolean, "registered_at" numeric NOT NULL, "approved_at" numeric, "event_id" character varying, CONSTRAINT "PK_cb23dc9d28df8801b15e9e2b8d6" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_e273290b4292fe15ea3b0d0351" ON "registration" ("event_id") `)
        await db.query(`CREATE TABLE "event_token" ("id" character varying NOT NULL, "token_address" text NOT NULL, "price" numeric NOT NULL, "event_id" character varying, CONSTRAINT "PK_d201bf824cd72132b9e72785c9d" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_f1e86d71aa04b69b2ec68a3d73" ON "event_token" ("event_id") `)
        await db.query(`CREATE TABLE "payment" ("id" character varying NOT NULL, "payer" text NOT NULL, "amount" numeric NOT NULL, "payment_date" numeric NOT NULL, "is_refunded" boolean NOT NULL, "event_id" character varying, "token_id" character varying, "registration_id" character varying, CONSTRAINT "PK_fcaec7df5adf9cac408c686b2ab" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_7e4a9d66fdf160a9fb9d236150" ON "payment" ("event_id") `)
        await db.query(`CREATE INDEX "IDX_dd7d291c180f33c6ed2b707c17" ON "payment" ("token_id") `)
        await db.query(`CREATE INDEX "IDX_78c29983ce0c63267ed64a8bf6" ON "payment" ("registration_id") `)
        await db.query(`CREATE TABLE "ticket" ("id" character varying NOT NULL, "attendee" text NOT NULL, "issued_at" numeric NOT NULL, "is_used" boolean NOT NULL, "checked_in_at" numeric, "event_id" character varying, "registration_id" character varying, "payment_id" character varying, CONSTRAINT "REL_1b0d23f9b5adc281af44f382ef" UNIQUE ("registration_id"), CONSTRAINT "REL_080fdcb740809a21228fccaf67" UNIQUE ("payment_id"), CONSTRAINT "PK_d9a0835407701eb86f874474b7c" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_902a22d2110174b48925314c87" ON "ticket" ("event_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_1b0d23f9b5adc281af44f382ef" ON "ticket" ("registration_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_080fdcb740809a21228fccaf67" ON "ticket" ("payment_id") `)
        await db.query(`CREATE TABLE "poap" ("id" character varying NOT NULL, "poap_id" integer NOT NULL, "fancy_id" text NOT NULL, "name" text NOT NULL, "description" text NOT NULL, "city" text, "country" text, "event_url" text, "image_url" text, "animation_url" text, "year" integer, "start_date" text, "end_date" text, "expiry_date" text, "from_admin" boolean, "virtual_event" boolean, "event_template_id" integer, "private_event" boolean, "drop_image_public_id" text, "drop_image_drop_id" integer, "event_id" character varying, CONSTRAINT "PK_9c67dcdc86aaf9d1b2bba6ed663" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_19b1c0c39337fd75ca73a5f251" ON "poap" ("poap_id") `)
        await db.query(`CREATE INDEX "IDX_1d1de0ad1ac3dd184cb96c66ee" ON "poap" ("fancy_id") `)
        await db.query(`CREATE INDEX "IDX_2b2f68133725d9a7acf50e4870" ON "poap" ("event_id") `)
        await db.query(`CREATE TABLE "event" ("id" character varying NOT NULL, "event_id" numeric NOT NULL, "organizer" text NOT NULL, "metadata_hash" text NOT NULL, "start_date" numeric NOT NULL, "end_date" numeric NOT NULL, "venue_type" text NOT NULL, "requires_approval" boolean NOT NULL, "capacity" numeric NOT NULL, "is_active" boolean NOT NULL, "is_paid" boolean NOT NULL, "created_at" numeric NOT NULL, "updated_at" numeric, "metadata_id" character varying, CONSTRAINT "PK_30c2f3bbaf6d34a55f8ae6e4614" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_fe0840e4557d98ed53b0ae5146" ON "event" ("event_id") `)
        await db.query(`CREATE INDEX "IDX_155aaa70119f077c016f931c8f" ON "event" ("organizer") `)
        await db.query(`CREATE INDEX "IDX_f9e5249129bc322437853cf93f" ON "event" ("metadata_id") `)
        await db.query(`CREATE INDEX "IDX_6d225d2181fcfcebdfd7ac5365" ON "event" ("start_date") `)
        await db.query(`CREATE INDEX "IDX_fb931d7d954ab53421bbd19ad3" ON "event" ("end_date") `)
        await db.query(`CREATE INDEX "IDX_f85a1ea6996d7e1d617425b90a" ON "event" ("is_active") `)
        await db.query(`CREATE TABLE "whitelisted_token" ("id" character varying NOT NULL, "token_address" text NOT NULL, "is_whitelisted" boolean NOT NULL, "updated_at" numeric NOT NULL, CONSTRAINT "PK_b21b5c5d3cdbd31c263e85ff61e" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "profit" ("id" character varying NOT NULL, "event_id" numeric, "token" text NOT NULL, "profit_amount" numeric NOT NULL, "withdrawn_amount" numeric, "recipient" text, "created_at" numeric NOT NULL, "withdrawn_at" numeric, "type" text NOT NULL, CONSTRAINT "PK_05c5b23d902e191f87ea11ed6e4" PRIMARY KEY ("id"))`)
        await db.query(`ALTER TABLE "location" ADD CONSTRAINT "FK_2c7b2ffbd1f600a35f87317f7a7" FOREIGN KEY ("metadata_id") REFERENCES "event_metadata"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "event_metadata" ADD CONSTRAINT "FK_0817c16131339484069f1af3cb3" FOREIGN KEY ("event_id") REFERENCES "event"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "event_metadata" ADD CONSTRAINT "FK_e3d88724099f9665ad312a39f73" FOREIGN KEY ("location_id") REFERENCES "location"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "registration" ADD CONSTRAINT "FK_e273290b4292fe15ea3b0d03511" FOREIGN KEY ("event_id") REFERENCES "event"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "event_token" ADD CONSTRAINT "FK_f1e86d71aa04b69b2ec68a3d73a" FOREIGN KEY ("event_id") REFERENCES "event"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "payment" ADD CONSTRAINT "FK_7e4a9d66fdf160a9fb9d236150f" FOREIGN KEY ("event_id") REFERENCES "event"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "payment" ADD CONSTRAINT "FK_dd7d291c180f33c6ed2b707c179" FOREIGN KEY ("token_id") REFERENCES "event_token"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "payment" ADD CONSTRAINT "FK_78c29983ce0c63267ed64a8bf6f" FOREIGN KEY ("registration_id") REFERENCES "registration"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "ticket" ADD CONSTRAINT "FK_902a22d2110174b48925314c875" FOREIGN KEY ("event_id") REFERENCES "event"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "ticket" ADD CONSTRAINT "FK_1b0d23f9b5adc281af44f382efa" FOREIGN KEY ("registration_id") REFERENCES "registration"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "ticket" ADD CONSTRAINT "FK_080fdcb740809a21228fccaf674" FOREIGN KEY ("payment_id") REFERENCES "payment"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "poap" ADD CONSTRAINT "FK_2b2f68133725d9a7acf50e48708" FOREIGN KEY ("event_id") REFERENCES "event"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "event" ADD CONSTRAINT "FK_f9e5249129bc322437853cf93fd" FOREIGN KEY ("metadata_id") REFERENCES "event_metadata"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "location"`)
        await db.query(`DROP INDEX "IDX_2c7b2ffbd1f600a35f87317f7a"`)
        await db.query(`DROP TABLE "event_metadata"`)
        await db.query(`DROP INDEX "IDX_0817c16131339484069f1af3cb"`)
        await db.query(`DROP INDEX "IDX_e3d88724099f9665ad312a39f7"`)
        await db.query(`DROP TABLE "registration"`)
        await db.query(`DROP INDEX "IDX_e273290b4292fe15ea3b0d0351"`)
        await db.query(`DROP TABLE "event_token"`)
        await db.query(`DROP INDEX "IDX_f1e86d71aa04b69b2ec68a3d73"`)
        await db.query(`DROP TABLE "payment"`)
        await db.query(`DROP INDEX "IDX_7e4a9d66fdf160a9fb9d236150"`)
        await db.query(`DROP INDEX "IDX_dd7d291c180f33c6ed2b707c17"`)
        await db.query(`DROP INDEX "IDX_78c29983ce0c63267ed64a8bf6"`)
        await db.query(`DROP TABLE "ticket"`)
        await db.query(`DROP INDEX "IDX_902a22d2110174b48925314c87"`)
        await db.query(`DROP INDEX "IDX_1b0d23f9b5adc281af44f382ef"`)
        await db.query(`DROP INDEX "IDX_080fdcb740809a21228fccaf67"`)
        await db.query(`DROP TABLE "poap"`)
        await db.query(`DROP INDEX "IDX_19b1c0c39337fd75ca73a5f251"`)
        await db.query(`DROP INDEX "IDX_1d1de0ad1ac3dd184cb96c66ee"`)
        await db.query(`DROP INDEX "IDX_2b2f68133725d9a7acf50e4870"`)
        await db.query(`DROP TABLE "event"`)
        await db.query(`DROP INDEX "IDX_fe0840e4557d98ed53b0ae5146"`)
        await db.query(`DROP INDEX "IDX_155aaa70119f077c016f931c8f"`)
        await db.query(`DROP INDEX "IDX_f9e5249129bc322437853cf93f"`)
        await db.query(`DROP INDEX "IDX_6d225d2181fcfcebdfd7ac5365"`)
        await db.query(`DROP INDEX "IDX_fb931d7d954ab53421bbd19ad3"`)
        await db.query(`DROP INDEX "IDX_f85a1ea6996d7e1d617425b90a"`)
        await db.query(`DROP TABLE "whitelisted_token"`)
        await db.query(`DROP TABLE "profit"`)
        await db.query(`ALTER TABLE "location" DROP CONSTRAINT "FK_2c7b2ffbd1f600a35f87317f7a7"`)
        await db.query(`ALTER TABLE "event_metadata" DROP CONSTRAINT "FK_0817c16131339484069f1af3cb3"`)
        await db.query(`ALTER TABLE "event_metadata" DROP CONSTRAINT "FK_e3d88724099f9665ad312a39f73"`)
        await db.query(`ALTER TABLE "registration" DROP CONSTRAINT "FK_e273290b4292fe15ea3b0d03511"`)
        await db.query(`ALTER TABLE "event_token" DROP CONSTRAINT "FK_f1e86d71aa04b69b2ec68a3d73a"`)
        await db.query(`ALTER TABLE "payment" DROP CONSTRAINT "FK_7e4a9d66fdf160a9fb9d236150f"`)
        await db.query(`ALTER TABLE "payment" DROP CONSTRAINT "FK_dd7d291c180f33c6ed2b707c179"`)
        await db.query(`ALTER TABLE "payment" DROP CONSTRAINT "FK_78c29983ce0c63267ed64a8bf6f"`)
        await db.query(`ALTER TABLE "ticket" DROP CONSTRAINT "FK_902a22d2110174b48925314c875"`)
        await db.query(`ALTER TABLE "ticket" DROP CONSTRAINT "FK_1b0d23f9b5adc281af44f382efa"`)
        await db.query(`ALTER TABLE "ticket" DROP CONSTRAINT "FK_080fdcb740809a21228fccaf674"`)
        await db.query(`ALTER TABLE "poap" DROP CONSTRAINT "FK_2b2f68133725d9a7acf50e48708"`)
        await db.query(`ALTER TABLE "event" DROP CONSTRAINT "FK_f9e5249129bc322437853cf93fd"`)
    }
}
